# ğŸ§® Calculadora DistribuÃ­da com gRPC

**Trabalho PrÃ¡tico 2 - RPC**  
**Disciplina:** Sistemas Paralelos e DistribuÃ­dos  
**Professor:** Danielle Valente  
**Semestre:** 2025-02

---

## ğŸ“‹ DescriÃ§Ã£o do Projeto

ImplementaÃ§Ã£o de uma **Calculadora DistribuÃ­da** utilizando gRPC em Python. O sistema oferece operaÃ§Ãµes bÃ¡sicas (adiÃ§Ã£o, subtraÃ§Ã£o, multiplicaÃ§Ã£o e divisÃ£o) atravÃ©s de chamadas RPC unÃ¡rias, seguindo a arquitetura stateless.

### âœ¨ Funcionalidades Implementadas

#### Requisitos BÃ¡sicos (NÃ­vel 0):
- âœ… OperaÃ§Ãµes bÃ¡sicas: Add, Sub, Mul, Div
- âœ… Chamadas unÃ¡rias gRPC
- âœ… Arquitetura stateless
- âœ… CÃ³digo comentado e documentado

#### Extras Opcionais:
- âœ… **Interceptors de log** no servidor
- âœ… **ValidaÃ§Ã£o de entrada** (divisÃ£o por zero)
- âœ… **Testes com grpcurl**
- âœ… Cliente interativo com menu
- âœ… Suite de testes automatizados

---

## ğŸ“ Estrutura do Projeto

```
calculadora-grpc/
â”‚
â”œâ”€â”€ calculator.proto              # DefiniÃ§Ã£o do serviÃ§o gRPC
â”œâ”€â”€ server.py                     # Servidor gRPC com interceptors
â”œâ”€â”€ client.py                     # Cliente interativo
â”œâ”€â”€ requirements.txt              # DependÃªncias Python
â”œâ”€â”€ test_grpcurl.sh              # Script de testes com grpcurl
â”œâ”€â”€ README.md                     # Este arquivo
â”‚
â”œâ”€â”€ calculator_pb2.py            # Gerado automaticamente
â””â”€â”€ calculator_pb2_grpc.py       # Gerado automaticamente
```

---

## ğŸš€ ConfiguraÃ§Ã£o e InstalaÃ§Ã£o

### PrÃ©-requisitos

- Python 3.8 ou superior
- pip (gerenciador de pacotes Python)

### Passo 1: Instalar DependÃªncias

```bash
# Instalar as bibliotecas necessÃ¡rias
pip install -r requirements.txt
```

### Passo 2: Gerar CÃ³digo gRPC

O comando abaixo gera os arquivos Python a partir do arquivo `.proto`:

```bash
python -m grpc_tools.protoc -I. --python_out=. --grpc_python_out=. calculator.proto
```

**Arquivos gerados:**
- `calculator_pb2.py` - Classes para mensagens Protocol Buffer
- `calculator_pb2_grpc.py` - Classes para serviÃ§o gRPC

---

## ğŸ¯ Executando o Projeto

### 1ï¸âƒ£ Iniciar o Servidor

Em um terminal, execute:

```bash
python server.py
```

**SaÃ­da esperada:**
```
2025-10-27 10:00:00 - INFO - ğŸš€ Servidor gRPC iniciado na porta 50051
2025-10-27 10:00:00 - INFO - ğŸ“¡ Aguardando requisiÃ§Ãµes...
```

### 2ï¸âƒ£ Executar o Cliente

Em outro terminal, execute:

```bash
python client.py
```

VocÃª verÃ¡ um menu interativo:

```
==================================================
ğŸ§® CALCULADORA DISTRIBUÃDA - gRPC
==================================================
1. â• AdiÃ§Ã£o
2. â– SubtraÃ§Ã£o
3. âœ–ï¸  MultiplicaÃ§Ã£o
4. â— DivisÃ£o
5. ğŸ§ª Executar Testes Automatizados
0. ğŸšª Sair
==================================================
```

### 3ï¸âƒ£ Executar Testes com grpcurl (Opcional)

Primeiro, instale o grpcurl (se necessÃ¡rio):

```bash
# No Linux/Mac com Homebrew
brew install grpcurl

# Ou baixe do GitHub
# https://github.com/fullstorydev/grpcurl/releases
```

Depois execute o script de testes:

```bash
chmod +x test_grpcurl.sh
./test_grpcurl.sh
```

---

## ğŸ§ª Casos de Teste

O cliente inclui uma suite automatizada de testes que valida:

1. âœ… **AdiÃ§Ã£o bÃ¡sica** (10 + 5)
2. âœ… **SubtraÃ§Ã£o bÃ¡sica** (10 - 5)
3. âœ… **MultiplicaÃ§Ã£o bÃ¡sica** (10 Ã— 5)
4. âœ… **DivisÃ£o bÃ¡sica** (10 Ã· 5)
5. âœ… **OperaÃ§Ãµes com negativos** (-10 + 5)
6. âœ… **SubtraÃ§Ã£o com negativos** (-10 - (-5))
7. âœ… **MultiplicaÃ§Ã£o por zero** (10 Ã— 0)
8. âš ï¸ **DivisÃ£o por zero** (10 Ã· 0) - **DEVE FALHAR**
9. âœ… **DivisÃ£o com decimais** (7 Ã· 3)
10. âœ… **NÃºmeros grandes** (999999 Ã— 999999)

Para executar os testes automatizados, escolha a opÃ§Ã£o **5** no menu do cliente.

---

## ğŸ”§ Testando com grpcurl

### Listar serviÃ§os disponÃ­veis:
```bash
grpcurl -plaintext localhost:50051 list
```

### Listar mÃ©todos do Calculator:
```bash
grpcurl -plaintext localhost:50051 list calculator.Calculator
```

### Testar operaÃ§Ã£o de adiÃ§Ã£o:
```bash
grpcurl -plaintext -d '{"num1": 10, "num2": 5}' \
    localhost:50051 calculator.Calculator/Add
```

### Testar divisÃ£o por zero (deve retornar erro):
```bash
grpcurl -plaintext -d '{"num1": 10, "num2": 0}' \
    localhost:50051 calculator.Calculator/Div
```

---

## ğŸ“Š Arquitetura e EstratÃ©gias de Projeto

### Arquitetura Stateless

O servidor **nÃ£o mantÃ©m estado** entre requisiÃ§Ãµes. Cada operaÃ§Ã£o Ã© independente:
- âœ… Permite escalabilidade horizontal
- âœ… Facilita tolerÃ¢ncia a falhas
- âœ… Simplifica o design do sistema

### Interceptors de Log

Implementado um **interceptor de servidor** que:
- ğŸ“ Registra todas as requisiÃ§Ãµes recebidas
- â±ï¸ Mede tempo de processamento
- ğŸ” Auxilia no debug e monitoramento

### ValidaÃ§Ã£o de Entrada

A operaÃ§Ã£o de **divisÃ£o** inclui validaÃ§Ã£o:
- âš ï¸ Detecta divisÃ£o por zero antes do cÃ¡lculo
- ğŸš« Retorna erro apropriado ao cliente
- ğŸ“‹ Define cÃ³digo de status gRPC (INVALID_ARGUMENT)

### Tratamento de Erros

Todas as operaÃ§Ãµes possuem:
- Try-catch para exceÃ§Ãµes
- Mensagens de erro descritivas
- Flag `success` na resposta
- Logging de erros no servidor

---

## ğŸ“ Conceitos gRPC Demonstrados

### 1. Protocol Buffers
- DefiniÃ§Ã£o de mensagens fortemente tipadas
- SerializaÃ§Ã£o eficiente de dados
- Contrato de interface (`.proto`)

### 2. Chamadas UnÃ¡rias
- RequisiÃ§Ã£o â†’ Resposta (1:1)
- PadrÃ£o request-response tradicional
- Todas as 4 operaÃ§Ãµes implementadas assim

### 3. Interceptors
- Middleware para logging
- Processamento antes/depois das requisiÃ§Ãµes
- SeparaÃ§Ã£o de concerns (logging vs lÃ³gica de negÃ³cio)

### 4. CÃ³digos de Status
- `OK` para operaÃ§Ãµes bem-sucedidas
- `INVALID_ARGUMENT` para divisÃ£o por zero
- Tratamento de erros padronizado

---

## ğŸ“ Comandos Ãšteis

### Gerar novamente os arquivos gRPC:
```bash
python -m grpc_tools.protoc -I. --python_out=. --grpc_python_out=. calculator.proto
```

### Iniciar servidor em modo debug:
```bash
python -u server.py
```

### Verificar se a porta estÃ¡ aberta:
```bash
# Linux/Mac
lsof -i :50051

# Windows
netstat -ano | findstr :50051
```

### Parar o servidor:
```
Ctrl + C
```

---

## ğŸ› Troubleshooting

### Erro: "ModuleNotFoundError: No module named 'calculator_pb2'"
**SoluÃ§Ã£o:** Execute o comando de geraÃ§Ã£o do cÃ³digo gRPC:
```bash
python -m grpc_tools.protoc -I. --python_out=. --grpc_python_out=. calculator.proto
```

### Erro: "failed to connect to all addresses"
**SoluÃ§Ã£o:** Certifique-se de que o servidor estÃ¡ rodando:
```bash
python server.py
```

### Erro: "Address already in use"
**SoluÃ§Ã£o:** A porta 50051 jÃ¡ estÃ¡ em uso. Mate o processo:
```bash
# Linux/Mac
lsof -ti:50051 | xargs kill -9

# Ou mude a porta no cÃ³digo
```

---

## ğŸ“š Fontes de Consulta

- **gRPC Documentation:** https://grpc.io/docs/languages/python/
- **Protocol Buffers Guide:** https://protobuf.dev/
- **grpcurl GitHub:** https://github.com/fullstorydev/grpcurl
- **Python gRPC Tutorial:** https://grpc.io/docs/languages/python/basics/

---

## ğŸ‘¥ Autores

**[Caio Bertoldo e Leonardo Abinader]**  
Engenharia da ComputaÃ§Ã£o 
Sistemas Paralelos e DistribuÃ­dos - 2025-02

---

## ğŸ“„ LicenÃ§a

Este projeto foi desenvolvido para fins educacionais como parte do curso de Sistemas Paralelos e DistribuÃ­dos.

---

**Data de Entrega:** 27/10/2025  
**Professor:** Danielle Valente